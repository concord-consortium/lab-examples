<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300italic,400,300,700&amp;subset=latin,greek,latin-ext" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet" type="text/css">
    <style type="text/css">
      a {
        cursor: pointer;
      }
      div {
        margin: 1em;
      }
    </style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="http://lab.dev.concord.org/vendor/iframe-phone/iframe-phone.js"></script>
  </head>
  <body>
    <h1>Embedded empty Lab interactive waiting for Interactive JSON to be sent using iframe-phone</h1>
    <p>
      Demonstrates embedding an empty Lab interactive that is waiting for Interactive JSON to be provided using 
      <a target="_blank" href="https://github.com/concord-consortium/iframe-phone">iframe-phone</a>.
    </p>
    <p>
      <a id="send-json">Send Interactive JSON to iframe</a>
    </p>
    <iframe id="interactive-iframe" width="565px" height="435px"
            frameborder="no" scrolling="no" allowfullscreen="true"
            webkitallowfullscreen="true" mozallowfullscreen="true"
            src="http://lab.dev.concord.org/embeddable.html">
    </iframe>

    <script>
      // Call this function when jQuery thinks the page is ready.
      $(function () {
        // Intitialization.
        var phone = new iframePhone.ParentEndpoint($('#interactive-iframe')[0], function () {
          console.log("Connection with Lab iframe established.");
        });

        $('#send-json').click(function () {
          phone.post("loadInteractive", {
            "title": "Oil and Water",
            "publicationStatus": "sample",
            "subtitle": "Explore how polar and non-polar substances interact.",
            "about": [
              "It is well known that \"oil and water donâ€™t mix.\" But why? Run the model of",
              "polar water (blue and red) and non-polar oil (gray). \"Shake up the oil and water",
              "mixture,\" then run it again and watch what happens to the molecules over time."
            ],
            "models": [
              {
                "type": "md2d",
                "id": "page3$1",
                "url": "imports/legacy-mw-content/converted/sam-activities/intermolecular-attraction/original-interactives-in-pages/page3/page3$1.json",
                "viewOptions": {
                  "controlButtons": "play_reset",
                  "textBoxes": [
                    {
                      "text": "Separated oil and water",
                      "x": 1.08,
                      "y": 2.0,
                      "fontScale": 1.3,
                      "layer": 1,
                      "frame": "rounded rectangle",
                      "backgroundColor": "rgb(245,245,245)"
                    }
                  ]
                }
              },
              {
                "type": "md2d",
                "id": "oilAndWaterMix",
                "url": "imports/legacy-mw-content/converted/sam-activities/intermolecular-attraction/original-interactives-in-pages/page3/oilAndWaterMix.json",
                "viewOptions": {
                  "controlButtons": "play_reset",
                  "textBoxes": [
                    {
                      "text": "Oil and water shaken up and mixed",
                      "x": 0.804,
                      "y": 2.0,
                      "fontScale": 1.3,
                      "layer": 1,
                      "frame": "rounded rectangle",
                      "backgroundColor": "rgb(245,245,245)"
                    }
                  ]
                }
              }
            ],
            "components": [
              {
                "type": "button",
                "id": "shake",
                "text": "Shake up the oil and water mixture",
                "action": "loadModel('oilAndWaterMix');"
              }
            ],
            "layout": {
              "bottom": [
                "shake"
              ]
            }
          });
          console.log("Interactive JSON sent.");
        })
      });
    </script>
</body>
</html>